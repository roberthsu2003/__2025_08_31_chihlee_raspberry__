# 技術研究報告：貪食蛇遊戲

本文件記錄了為開發貪食蛇遊戲所做的關鍵技術決策。

---

## 1. Pygame 應用程式架構

- **問題**: Pygame 應用的最佳架構模式是什麼？

- **決策**: **採用狀態機模式 (State Machine Pattern)。**

- **理由**:
  對於像貪食蛇這樣具有明確、獨立狀態（例如：主選單、遊戲中、遊戲結束）的遊戲，狀態機是一個非常清晰且易於管理的架構。每個狀態可以封裝自己的邏輯和畫面渲染，使得主遊戲迴圈變得非常簡潔。相比之下，MVC 模式對於此規模的專案來說過於複雜。

- **考慮過的替代方案**:
  - **單一巨大迴圈**: 將所有邏輯放在一個 `while` 迴圈中。這會導致程式碼難以閱讀和維護。
  - **MVC (模型-視圖-控制器)**: 對於此專案而言，這是過度設計，會引入不必要的複雜性。

---

## 2. Pygame 中的文字渲染

- **問題**: 在 Pygame 中進行文字渲染和管理的最佳實踐是什麼？

- **決策**: **使用 `pygame.font.Font` 物件進行標準渲染。**

- **理由**:
  這是 Pygame 內建且最直接的方法。標準流程是：建立一個 `Font` 物件，使用 `.render()` 方法將文字建立為一個 `Surface`，然後將該 `Surface` 繪製（blit）到主畫面上。我們將建立一個輔助函式來封裝此流程，以便在遊戲中輕鬆顯示分數和訊息。

- **考慮過的替代方案**:
  - **使用第三方 UI 函式庫**: 這會增加外部相依性，對於僅需顯示幾行文字的簡單需求來說沒有必要。

---

## 3. JSON 資料持久化

- **問題**: 如何可靠地使用 JSON 檔案來讀寫最高分，並處理潛在錯誤？

- **決策**: **使用內建的 `json` 模組，並透過 `try...except` 處理錯誤。**

- **理由**:
  對於儲存使用者名稱和分數這種簡單的鍵值對資料，Python 的 `json` 模組已足夠。我們將實作一個 `ScoreManager` 類別，它會處理檔案的讀取和寫入。讀取時，它會處理 `FileNotFoundError`（在首次執行遊戲時發生）和 `json.JSONDecodeError`（在檔案損毀時發生）。寫入時，它會完整地覆寫檔案，這對於低頻率的寫入操作來說是安全且簡單的。對於單機遊戲，檔案鎖定是不必要的複雜功能。

- **考慮過的替代方案**:
  - **使用 `pickle`**: `pickle` 不是人類可讀的，且有潛在的安全風險。
  - **使用資料庫 (SQLite)**: 這違反了規格中「使用簡單本地檔案」的要求，且對於此需求來說過於複雜。
